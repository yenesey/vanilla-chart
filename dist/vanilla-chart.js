!function(){"use strict";var a=Math.min,_=Math.max,E=Math.round,H=Math.abs;function h(t,i,e,n){for(var o=0;o<i.length;o++)!1===n?t.removeEventListener(i[o],e):t.addEventListener(i[o],e)}var e={minimapHeightRel:.14,minimapBandSize:12,minimapBkColor:"#f8f8ff",minimapSelectColor:"#c8dde8",minimapLabelsColor:"#555"},n={run:!1,duration:200,ts:0,from:0,to:0,pos:0,onComplete:null};function t(t,i){if(this.data=null,this.visible={},this.options=e,this.container=document.getElementById(t),!this.container)throw new Error("chart container not found!");this.canvas=this.container.appendChild(document.createElement("canvas")),this.ctx=this.canvas.getContext("2d"),this.font=window.getComputedStyle(this.container,null).font,this.vw=0,this.vh=0,this.select=-1,this.minimap={left:0,right:0,rlLeft:.75,rlRight:1,sbSize:this.options.minimapBandSize},this._transitions={minimap:Object.create(n),graph:Object.create(n),pointer:Object.create(n)},this.setData(i);h(window,["resize","load"],function(){this.vw=this.canvas.width=this.container.clientWidth,this.vh=this.canvas.height=this.container.clientHeight,this.minimap.left=this.vw*this.minimap.rlLeft,this.minimap.right=this.vw*this.minimap.rlRight,this.draw()}.bind(this)),h(this.canvas,["mousemove","toucmove"],this.move.bind(this)),h(document,["mousedown","touchstart"],this.drag.bind(this))}(function(){var l=0,m=0,f={mode:0,start:0,left:0,right:0,runBnd:null,doneBnd:null};function c(t){var i=E(t.vh*t.options.minimapHeightRel),e=E(.1*i);return{y:t.vh-i+e,x:t.minimap.left,w:t.minimap.right-t.minimap.left,h:i-2*e}}function P(t,i){for(var e=0;e<t.columns.length;e++)if(t.columns[e][0]===i)return t.columns[e];return null}function z(t,i){return String.prototype.substr.apply(new Date(t),[[0,3],[4,11],[4,6],[11,4]][i])}function Y(t,i,e,n,o,r,s){var a=["arcTo","lineTo"];return s=s||[0,0,0,0],t.moveTo(i+r,e),t[a[s[0]]](i+n,e,i+n,e+o,r),t[a[s[1]]](i+n,e+o,i,e+o,r),t[a[s[2]]](i,e+o,i,e,r),t[a[s[3]]](i,e,i+n,e,r),t}function u(t,i,e,n,o,r,s,a,h,l,m,f,c,u){var d=t.measureText("M").width;u&&(o=o-d-8);var p=s/r,v=a/r,g=r/(i.columns[0].length-2),w=1/(v-p),y=o/m,b=n+o;for(var x in t.lineWidth=f,t.lineJoin="round",e){t.beginPath(),t.strokeStyle=i.colors[x];for(var T=P(i,x),S=h;S<=l;S++)t.lineTo((S*g-s)*w,b-T[S+1]*y);t.stroke()}if(u){t.lineWidth=.2,t.beginPath(),t.strokeStyle="grey";var B=m/8;t.fillStyle="#aaa";for(n=0;n<8;n++)t.moveTo(0,b-n*B*y),t.lineTo(r,b-n*B*y),t.fillText(E(n*B).toString(),5,b-n*B*y-d);t.stroke();var C=E(H(l-h)/8),R=P(i,"x");for(S=h;S<l;S++){var M=z(R[S+1],2),k=t.measureText(M).width;h<S&&S%C==0&&t.fillText(M,E((S*g-s)*w-k/2),b+d+6)}if(-1!==c){S=E((s*w+c)/(w*g));t.beginPath(),t.strokeStyle="grey",t.lineWidth=.5;var L=S*g*w-s*w;for(var x in t.moveTo(L,0),t.lineTo(L,o),t.stroke(),t.lineWidth=f,e){T=P(i,x);t.beginPath(),t.strokeStyle=i.colors[x],t.fillStyle="#fff";n=b-T[S+1]*y;t.arc(L,n,4,0,2*Math.PI,!1),t.fill(),t.stroke()}!function(t,i,e,n,o,r){var s=P(n,"x")[o],a=z(s,0)+", "+z(s,2),h=t.measureText(a).width,l={},m=0;for(var f in n.names)l[f]={},l[f].name=n.names[f],l[f].value=P(n,f)[o],l[f].width=_(t.measureText(l[f].name).width,t.measureText(l[f].value).width),l[f].color=n.colors[f],m+=l[f].width+10;i-=(m=_(h,m)+10)/2,t.fillStyle="#fff",t.strokeStyle="#eee",t.beginPath(),Y(t,i,1,m,3*r+10,6).fill(),t.stroke(),t.fillStyle="#000",t.beginPath(),t.fillText(a,i+m/2-h/2,r+2.5);var c=0,u=i,d=t.font;for(f in l)t.fillStyle=l[f].color,c=l[f].width,t.font=d.replace("12px","bold 14px"),t.fillText(l[f].value,u+10,2*r+2.5),t.font=d.replace("bold 14px","12px"),t.fillText(l[f].name,u+10,3*r+2.5),u=u+c+10;t.fill()}(t,L,0,i,S+1,1.8*d)}}}function t(){var t,i,e,n,o=this.ctx;o.clearRect(0,0,this.vw,this.vh),i=(t=this).ctx,e=t.minimap.sbSize,n=c(t),i.beginPath(),i.fillStyle=t.options.minimapBkColor,i.fillRect(0,n.y,n.x+e,n.h),i.fillRect(n.x+n.w-e,n.y,t.vw-n.x-n.w+e,n.h),i.fillStyle=t.options.minimapSelectColor,Y(i,n.x,n.y,e,n.h,6,[1,1,0,0]),Y(i,n.x+n.w-e,n.y,e,n.h,6,[0,0,1,1]),i.fill(),i.fillRect(n.x+e,n.y,n.w-2*e,2),i.fillRect(n.x+e,n.y+n.h-2,n.w-2*e,2),u(i,t.data,t.visible,n.y,n.h,t.vw,0,t.vw,0,t.dataLength,t.getMaxY(1,t.dataLength),1,-1,!1),0!==f.mode&&(i.beginPath(),i.fillStyle="rgba(200, 190, 190, 0.2)",i.arc(n.x+[0,e/2,n.w-e/2,n.w/2][f.mode],n.y+n.h/2,t._transitions.minimap.pos,0,2*Math.PI,!1),i.fill());var r=E(this.vh-this.vh*this.options.minimapHeightRel),s=this.vw/(this.dataLength-1),a=E(this.minimap.left/s),h=E(this.minimap.right/s);o.font=this.font,u(o,this.data,this.visible,0,r,this.vw,this.minimap.left,this.minimap.right,a,h,this._transitions.graph.pos,2,this.select,!0),o.beginPath(),o.fillStyle="rgba(200, 190, 190, 0.2)",o.arc(l,m,this._transitions.pointer.pos,0,2*Math.PI,!1),o.fill(),function(t){var i=!1;for(var e in t){var n=t[e];i=i||n.run,n.run&&(n.pos=n.from+(n.to-n.from)/n.duration*(performance.now()-n.ts),(n.to>n.from&&n.pos>=n.to||n.to<n.from&&n.pos<=n.to||n.to===n.from)&&(n.run=!1,n.pos=n.to,n.onComplete&&n.onComplete()))}return i}(this._transitions)&&this.draw()}this.draw=function(){requestAnimationFrame(t.bind(this))},this.move=function(t){var i=t.target.getBoundingClientRect();"touchstart"===t.type&&(t=t.targetTouches[0]);var e=t.pageX-i.left;t.pageY-i.top<this.vh-this.vh*this.options.minimapHeightRel&&(this.select=e,this.draw())},this.drag=function(t){if(!f.runBnd&&!f.doneBnd){var i,e,n,o,r,s=t.target.getBoundingClientRect();t.target.style.cursor="w-resize","touchstart"===t.type&&(t=t.targetTouches[0]),l=t.pageX-s.left,m=t.pageY-s.top,this.initTransition("pointer","current",30,function(){this._transitions.pointer.pos=0}.bind(this)),f.mode=(e=l,n=m,o=c(i=this),r=i.minimap.sbSize,n<o.y?7:o.x<=e&&e<=o.x+o.w&&o.y<=n&&n<=o.y+o.h?e<o.x+r?1:e>o.x+o.w-r?2:3:0),0<f.mode&&(f.start=t.clientX,f.left=this.minimap.left,f.right=this.minimap.right,f.runBnd=function(t){this.select=-1,"touchmove"===t.type&&(t=t.targetTouches[0]);var i=t.clientX-f.start,e=this.minimap;4&f.mode&&(i=-i),1&f.mode&&(e.left=f.left+i,e.left=_(e.left,1),e.left=a(e.left,e.right-2*e.sbSize-1)),2&f.mode&&(e.right=f.right+i,e.right=a(e.right,this.vw-1),e.right=_(e.right,e.left+2*e.sbSize+1)),e.rlLeft=e.left/this.vw,e.rlRight=e.right/this.vw;var n=this.vw/(this.dataLength-1),o=E(e.left/n),r=E(e.right/n);this.initTransition("graph","current",this.getMaxY(o,r))}.bind(this),f.doneBnd=function(t){"touchmove"!==t.type&&(t.target.style.cursor="default"),h(document,["mousemove","touchmove"],f.runBnd,!1),h(document,["mouseup","touchend"],f.doneBnd,!1),f.runBnd=null,f.doneBnd=null,this.initTransition("minimap","current",0,function(){f.mode=0})}.bind(this),h(document,["mousemove","touchmove"],f.runBnd),h(document,["mouseup","touchend"],f.doneBnd),this.initTransition("minimap","current",E(this.vh*this.options.minimapHeightRel/2)))}},this.setData=function(t){this.data=t;try{this.dataLength=t.columns[0].length-1}catch(t){throw new TypeError("incorrect <inputData> format")}for(var i in t.names)this.visible[i]=!0;this.initTransition("graph","current",this.getMaxY())},this.getMaxY=function(t,i){var e=0;for(var n in t=t||0,i=i||this.dataLength,this.visible)for(var o=P(this.data,n),r=t+1;r<i+1;r++)e=_(e,o[r]);return e},this.setVisibility=function(t,i){void 0===i?t in this.visible?delete this.visible[t]:this.visible[t]=!0:i?this.visible[t]=!0:delete this.visible[t],this.initTransition("graph","current",this.getMaxY())},this.initTransition=function(t,i,e,n){var o=this._transitions,r=o[t];r.from="current"===i?r.pos:i,r.pos=r.from,r.to=e,r.ts=performance.now(),r.onComplete=n;var s=!1;for(var a in o)s=s||o[a].run;s||this.draw(),r.run=!0}}).call(t.prototype),"undefined"!=typeof window&&(window.VanillaChart=t)}();