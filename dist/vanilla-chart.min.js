!function(){"use strict";var E=Math.min,X=Math.max,j=Math.round,r=Math.floor,F=function(t,i){return Math.log(i)/Math.log(t)};function g(t,i,n,e){for(var o=0;o<i.length;o++)!1===e?t.removeEventListener(i[o],n):t.addEventListener(i[o],n)}var n={padding:5,minimapHeightRel:.14,minimapBandSize:12,colors:{background:"#fff",minimap:"#f4f8ff",minimapFrame:"#c8dde8",minimapDrag:"rgba(175, 175, 210, 0.2)",label:"#666",labelBackground:"rgba(240, 240, 250, 0.82)"}},e={run:!1,duration:200,ts:0,from:0,to:0,pos:0,onComplete:null};function t(t,i){if(this.data=null,this.names={},this.tree=[],this.options=n,this.container=document.getElementById(t),!this.container)throw new Error("chart container not found!");this.canvas=this.container.appendChild(document.createElement("canvas")),this.ctx=this.canvas.getContext("2d"),this.ctx.font=window.getComputedStyle(this.container,null).font,this.font=this.ctx.font,this.vw=0,this.vh=0,this.select=-1,this.controls={h:0,vh:0,width:0},this.minimap={left:0,right:0,rlLeft:.75,rlRight:1,a:0,b:0,vh:0},this._transitions={minimap:Object.create(e),graph:Object.create(e),pointer:Object.create(e)},this.setData(i);g(window,["resize","load"],function(){this.vw=this.canvas.width=this.container.clientWidth,this.vh=this.canvas.height=this.container.clientHeight,this.minimap.left=j(this.vw*this.minimap.rlLeft),this.minimap.right=j(this.vw*this.minimap.rlRight),this.minimap.vh=j(this.vh*this.options.minimapHeightRel),this.controls.vh=(this.controls.h+2*this.options.padding)*(1+Math.floor(this.controls.width/this.vw)),this.select=-1,this.draw()}.bind(this)),g(this.canvas,["mousemove","toucmove"],this.move.bind(this)),g(this.canvas,["mousedown","touchstart"],this.mousetouch.bind(this))}(function(){var l=0,m=0,c={mode:0,start:0,left:0,right:0,runBnd:null,doneBnd:null};function o(t){for(var i=1<<Math.log2(t.dataLength-1)+1,n=new Array(2*i),e=0;e<=t.dataLength;e++){var o=-1;for(var r in t.names)if(t.names[r].visible){var a=I(t.data,r);o=X(o,a[e+1])}n[e]=o}for(e=t.dataLength;e<2*i;e++)n[e]=-1;for(e=i;e<2*i;e++)n[e]=n[e-i];for(e=i-1;0<e;e--)n[e]=X(n[2*e],n[2*e+1]);return n}function f(t,i){var n=i?t.minimap.a:0,e=i?t.minimap.b:t.dataLength-1;return function(t,i,n){var e=-1,o=t.length/2;for(i+=o-1,n+=o-1;i<=n;)1&i&&(e=X(e,t[i])),1&n||(e=X(e,t[n])),i=r((i+1)/2),n=r((n-1)/2);return e}(t.tree,n+1,e+1)}function u(t){var i=t.minimap,n=j(.1*i.vh);return{y:t.vh-i.vh+n-t.controls.vh,x:i.left,w:i.right-i.left,h:i.vh-2*n}}function d(t){if(0!==t.vw){var i=t.minimap,n=t.vw/(t.dataLength-1);i.rlLeft=i.left/t.vw,i.rlRight=i.right/t.vw,i.a=j(i.left/n),i.b=j(i.right/n)}}function v(t,i){var n=t.options.padding,e=t.controls,o=t.names,r=n,a=0,s=t.vh-e.vh+n;for(var h in t.data.names)r+o[h].width+n>t.vw&&(r=n,s=s+e.h+n),i&&i({x:r,y:s,w:o[h].width,h:e.h-n},h),r=r+o[h].width+n,a++;return a}function p(t,i,n){return n.x<=t&&t<=n.x+n.w&&n.y<=i&&i<=n.y+n.h}function I(t,i){for(var n=0;n<t.columns.length;n++)if(t.columns[n][0]===i)return t.columns[n];return null}function W(t,n,e){return t.replace(/(\d*\.?\d+)px/,function(t,i){return(e?"bold ":"")+Number(Number(i)+n)+"px"})}function _(t,i){return String.prototype.substr.apply(new Date(t),[[0,3],[4,11],[4,6],[11,4]][i])}function z(t,i,n,e,o,r,a){var s=["arcTo","lineTo"];return a=a||[0,0,0,0],t.moveTo(i+r,n),t[s[a[0]]](i+e,n,i+e,n+o,r),t[s[a[1]]](i+e,n+o,i,n+o,r),t[s[a[2]]](i,n+o,i,n,r),t[s[a[3]]](i,n,i+e,n,r),t}function s(t,i,n,e,o,r,a){var s=t.ctx,h=s.measureText("M").width;r&&(n=n-h-8);var l=t.data,m=t.names,c=0,f=t.vw,u=0,d=t.dataLength-1;e&&(u=X(0,t.minimap.a-1),d=E(t.minimap.b+1,t.dataLength-1),c=t.minimap.left,f=t.minimap.right);var v=t.vw,p=v/(t.dataLength-1),g=1/(f/v-c/v),w=n/a,y=i+n,b=0;for(var x in s.lineWidth=o,s.lineJoin="round",s.font=t.font,m)if(m[x].visible){b++,s.beginPath(),s.strokeStyle=l.colors[x];for(var T=I(l,x),S=u;S<=d;S++)s.lineTo((S*p-c)*g,y-T[S+1]*w);s.stroke()}if(r&&0===b){var B="No data to display",P=s.measureText(B).width;return s.fillStyle=t.options.colors.label,s.font=W(s.font,4,!1),void s.fillText(B,v/2-P/2,n/2)}if(r){s.lineWidth=.2,s.beginPath(),s.strokeStyle="grey",s.fillStyle=t.options.colors.label;var k=j(X(0,F(2,n/6/w)));for(S=0;S<a;){i=S*w;s.moveTo(0,y-i),s.lineTo(v,y-i),s.fillText(j(S).toString(),5,y-i),S+=Math.pow(2,k)}s.stroke();for(var M,L,R=j(7*h),C=(k=j(X(0,F(2,R/(p*g)))),S=1,I(l,"x"));S<d;){h<(D=(S*p-c)*g)&&(M=_(C[S+1],2),L=s.measureText(M).width,s.fillText(M,j(D-L/2),y+h+6)),S+=Math.pow(2,k)}if(-1!==t.select){S=j((c*g+t.select)/(g*p));s.beginPath(),s.strokeStyle="grey",s.lineWidth=.5;var D=S*p*g-c*g;for(var x in s.moveTo(D,5*h),s.lineTo(D,n),s.stroke(),s.lineWidth=o,m)if(m[x].visible){T=I(l,x);s.beginPath(),s.strokeStyle=l.colors[x],s.fillStyle=t.options.colors.background;i=y-T[S+1]*w;s.arc(D,i,4,0,2*Math.PI,!1),s.fill(),s.stroke()}!function(t,i,n,e,o,r,a,s,h,l){var m=I(n,"x")[o],c=_(m,0)+", "+_(m,2),f=t.measureText(c).width,u={},d=0;for(var v in n.names)e[v].visible&&(u[v]={},u[v].name=n.names[v],u[v].value=I(n,v)[o],u[v].width=X(t.measureText(u[v].name).width,t.measureText(u[v].value).width),u[v].color=n.colors[v],d+=u[v].width+10);(i-=(d=X(f,d)+10)/2)<0&&(i=0),l<i+d&&(i=l-d),t.fillStyle=a,t.strokeStyle=s,t.beginPath(),z(t,i,1,d,3*r+10,6).fill(),t.stroke(),t.fillStyle=h,t.beginPath(),t.fillText(c,i+d/2-f/2,r+5);var p=0,g=i,w=t.font,y=W(t.font,2,!0);for(v in u)t.fillStyle=u[v].color,p=u[v].width,t.font=y,t.fillText(u[v].value,g+10,2*r+10),t.font=w,t.fillText(u[v].name,g+10,3*r+10/1.2),g=g+p+10;t.fill()}(s,D,l,t.names,S+1,1.4*h,t.options.colors.labelBackground,t.options.colors.minimap,t.options.colors.label,v)}}}function t(){var t,i,n,e,o,r=this.ctx;r.fillStyle=this.options.colors.background,r.fillRect(0,0,this.vw,this.vh),r.font=this.font,0===this.minimap.b&&(d(this),this.initTransition("graph","current",f(this,!0))),function(n){var e=n.ctx;e.font=W(n.font,4);var o=n.data;v(n,function(t,i){e.beginPath(),e.fillStyle=n.options.colors.minimap,e.strokeStyle="grey",e.lineWidth=.3,z(e,t.x,t.y,t.w,t.h,t.h/2).fill(),e.stroke(),e.textBaseline="middle",n.names[i].visible?(e.beginPath(),e.fillStyle=o.colors[i],e.arc(t.x+t.h/2,t.y+t.h/2,t.h/3,0,2*Math.PI,!1),e.fill(),e.font=W(n.font,4,!0),e.beginPath(),e.fillStyle="#fff",e.fillText("âœ“",t.x+.33*t.h,t.y+.52*t.h),e.font=W(n.font,4)):(e.beginPath(),e.lineWidth=1,e.strokeStyle=o.colors[i],e.arc(t.x+t.h/2,t.y+t.h/2,t.h/3,0,2*Math.PI,!1),e.stroke()),e.fillStyle=o.colors[i],e.beginPath(),e.fillText(o.names[i],t.x+t.h,t.y+t.h/2),e.textBaseline="bottom"})}(this),i=(t=this).ctx,n=t.options.minimapBandSize,e=t.options.colors,o=u(t),i.beginPath(),i.fillStyle=e.minimap,i.fillRect(0,o.y,o.x+n,o.h),i.fillRect(o.x+o.w-n,o.y,t.vw-o.x-o.w+n,o.h),i.fillStyle=e.minimapFrame,z(i,o.x,o.y,n,o.h,6,[1,1,0,0]),z(i,o.x+o.w-n,o.y,n,o.h,6,[0,0,1,1]),i.fill(),i.fillRect(o.x+n,o.y,o.w-2*n,2),i.fillRect(o.x+n,o.y+o.h-2,o.w-2*n,2),s(t,o.y,o.h,!1,1,!1,f(t,!1)),0!==c.mode&&(i.beginPath(),i.fillStyle=e.minimapDrag,i.arc(o.x+[0,n/2,o.w-n/2,o.w/2][c.mode],o.y+o.h/2,t._transitions.minimap.pos,0,2*Math.PI,!1),i.fill()),s(this,0,j(this.vh-this.minimap.vh-this.controls.vh),!0,2,!0,this._transitions.graph.pos);var a=this._transitions.pointer.pos;0<a&&(r.beginPath(),r.fillStyle=this.options.colors.minimapDrag,r.arc(l,m,a,0,2*Math.PI,!1),12<a&&r.arc(l,m,a-12,0,2*Math.PI,!0),r.fill()),function(t){var i=!1;for(var n in t){var e=t[n];i=i||e.run,e.run&&(e.pos=e.from+(e.to-e.from)/e.duration*(performance.now()-e.ts),(e.to>e.from&&e.pos>=e.to||e.to<e.from&&e.pos<=e.to||e.to===e.from)&&(e.run=!1,e.pos=e.to,e.onComplete&&e.onComplete()))}return i}(this._transitions)&&this.draw()}this.draw=function(){requestAnimationFrame(t.bind(this))},this.move=function(t){var i=t.target.getBoundingClientRect();"touchstart"===t.type&&(t=t.targetTouches[0]);var n=t.clientX-i.left;t.clientY-i.top<this.vh-this.minimap.vh-this.controls.vh&&(this.select=n,this.draw())},this.mousetouch=function(t){if(!c.runBnd&&!c.doneBnd){var i,n,e,o,r,a=t.target.getBoundingClientRect(),s=t;if("touchstart"===t.type&&(t=t.targetTouches[0]),l=t.clientX-a.left,m=t.clientY-a.top,c.mode=(n=l,e=m,o=u(i=this),r=i.options.minimapBandSize,e<o.y?7:p(n,e,o)?n<o.x+r?1:n>o.x+o.w-r?2:3:0),0<c.mode)s.target.style.cursor="w-resize",c.start=t.clientX,c.left=this.minimap.left,c.right=this.minimap.right,c.runBnd=function(t){this.select=-1;var i=0;t&&("touchmove"===t.type&&(t=t.targetTouches[0]),i=t.clientX-c.start);var n=this.minimap,e=this.options.minimapBandSize;4&c.mode&&(i=-i),1&c.mode&&(n.left=c.left+i,n.left=X(n.left,1),n.left=E(n.left,n.right-2*e-1)),2&c.mode&&(n.right=c.right+i,n.right=E(n.right,this.vw-1),n.right=X(n.right,n.left+2*e+1)),d(this),this.initTransition("graph","current",f(this,!0))}.bind(this),c.doneBnd=function(t){"touchmove"!==t.type&&(t.target.style.cursor="default"),g(document,["mousemove","touchmove"],c.runBnd,!1),g(document,["mouseup","touchend"],c.doneBnd,!1),c.runBnd=null,c.doneBnd=null,this.initTransition("minimap","current",0,function(){c.mode=0})}.bind(this),g(document,["mousemove","touchmove"],c.runBnd),g(document,["mouseup","touchend"],c.doneBnd),this.initTransition("minimap","current",j(.65*this.minimap.vh));else{var h=this;v(this,function(t,i){p(l,m,t)&&(s.preventDefault(),h.setVisibility(i),h.initTransition("pointer","current",50,function(){h._transitions.pointer.pos=0}.bind(h)))})}}},this.setData=function(t){this.data=t;try{this.dataLength=t.columns[0].length-1}catch(t){throw new TypeError("incorrect <inputData> format")}var i=this.ctx;for(var n in i.font=W(this.font,4,!0),this.controls.h=j(3.5*i.measureText("M").width),this.controls.width=0,this.names={},t.names){var e=i.measureText(t.names[n]).width+this.controls.h+2*this.options.padding;this.controls.width+=e,this.names[n]={visible:!0,width:e-this.options.padding}}this.tree=o(this),this.initTransition("graph","current",f(this,!0))},this.setVisibility=function(t,i){this.names[t].visible=void 0===i?!this.names[t].visible:i,this.tree=o(this),this.initTransition("graph","current",f(this,!0))},this.initTransition=function(t,i,n,e){var o=this._transitions,r=o[t];r.from="current"===i?r.pos:i,r.pos=r.from,r.to=n,r.ts=performance.now(),r.onComplete=e;var a=!1;for(var s in o)a=a||o[s].run;a||this.draw(),r.run=!0}}).call(t.prototype),"undefined"!=typeof window&&(window.VanillaChart=t)}();
//# sourceMappingURL=vanilla-chart.min.js.map